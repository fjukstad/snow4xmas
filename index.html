<html>
    <head>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <style>
    body { 
        font-family: "Helvetica Neue";
    }
    h1 {
        text-align: center;
    }
    </style> 
    </head>
    <body>
        <h1> Snow depth in Troms√∏ </h1> 
        <script> 
                
            for(i = 1990; i <= 2016; i++){
                var year = i
                CreateSnowPlot(year);       
           }

            function CreateSnowPlot(year) { 
                var width = 200;
                var height = 100;
                var y = d3.scaleLinear()
                    .domain([-1,250])
                    .range([height,0]);
                 var x = d3.scaleTime()
                    .domain([new Date(year, 1, 1), new Date(year, 12, 30)])
                    .range([0, width]);

                var url = "/snow?year="+year

                var svg = d3.select("body").append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .attr("id", "snow-"+year)
                  .append("g")
                  .attr("id", "snow-"+year) 

                d3.json(url, function(error, data){
                  svg.selectAll("g")
                      .data(data)
                      .enter().append("circle") 
                      .attr("r", 0.5)
                      .attr("cx", function(d){
                          dat = new Date(d.Date)
                          return x(dat)
                      })
                      .attr("cy", function(d){
                          return y(d.Thickness)
                      })
                      .attr("date", function(d){
                          return d.Date
                      })
                })
                
                svg.append("g")
                    .attr("transform","translate("+width/2+","+height/2+")")
                    .append("text")
                    .attr("text-anchor", "middle")
                    .text(year)

            }
        </script> 
    </body>
</html>
